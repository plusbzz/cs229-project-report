#LyX 2.0 created this file. For more info see http://www.lyx.org/
\lyxformat 413
\begin_document
\begin_header
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_amsmath 1
\use_esint 1
\use_mhchem 1
\use_mathdots 1
\cite_engine basic
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 3cm
\topmargin 3cm
\rightmargin 2cm
\bottommargin 3cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\author 534349327 "Raj Bandyopadhyay" 
\end_header

\begin_body

\begin_layout Title
Predicting airline delays
\end_layout

\begin_layout Author
Raj Bandyopadhyay, Rafael Guerrero
\end_layout

\begin_layout Date
12/14/2012
\end_layout

\begin_layout Section*
Introduction
\change_deleted 534349327 1355278790

\end_layout

\begin_layout Standard
In this project, we use publicly available data from the Bureau of Transportatio
n Statistics to analyse and predict flight departure delays for a subset
 of commercial flights in the United States.
 We have three goals in mind.
 First, we would like to identify some factors which are most likely to
 cause flight delays.
 Second, we want to predict if there will be a delay for an individual flight.
 Finally, if there is a delay, we would like to estimate its magnitude.
\end_layout

\begin_layout Standard
In this paper, we first describe the important features of the data, along
 with our preliminary pre-processing and analysis.
 As part of this step, we use linear regression to identify the most important
 factors affecting delays.
 Subsequently, we use a classifier (SVM) to predict if there will be a delay.
 For estimating the magnitude of delays, we use a non-parametric quadratic
 regression algorithm.
 
\end_layout

\begin_layout Section*
The airline delay data set
\end_layout

\begin_layout Standard
The original data set contains information for all commercial flights in
 the US from 1987 to 2008.
 Since the data set is extremely large (several million records) we extracted
 a reasonable subset of the data as follows:
\end_layout

\begin_layout Itemize
Two years: 2007 and 2008
\end_layout

\begin_layout Itemize
One airport of origin: O'Hare (Chicago), since it is one of the busiest
 airports and is exposed to a wide range of weather conditions
\end_layout

\begin_layout Itemize
One airline: AA (American Airlines), since it is the largest airline using
 the O'Hare airport
\end_layout

\begin_layout Standard
This reduces the size of our data set to around 75,000 records.
 For each record, we use secondary data sources to enrich it with information
 about airplanes and historical weather statistics.
 At the end of the pre-processing steps, our data set has the following
 features:
\end_layout

\begin_layout Itemize
Flight features: These include the times of departure and arrival, the destinati
on airport, and the distance covered by the flight.
 Except for the distance, we convert all other variables to categorical
 form.
\end_layout

\begin_layout Itemize
Airplane features: These include the make and model of the plane, its age
 and engine type 
\end_layout

\begin_layout Itemize
Weather features: We use the Weather Underground API to obtain historical
 weather information for the time closest to the departure time.
 The weather data includes several categorical features indicating the presence
 of snow, hail, thunder, rain and tornado warnings.
 In addition it also contains a few numeric features such as wind speed,
 temperature and humidity.
\end_layout

\begin_layout Section*
Preliminary analysis using Linear Regression
\end_layout

\begin_layout Standard
As our first pre-processing step, we use histograms and basic plots to eliminate
 some features that have no impact on the delays.
 These included features such as the airplane manufacturer and temperature.
 We then used linear regression (as implemented in R) as a quick-and-dirty
 first technique to examine the data.
 Our goal with linear regression was threefold: 
\end_layout

\begin_layout Enumerate
use the regression parameters to identify prominent factors affecting delays
\end_layout

\begin_layout Enumerate
get a baseline estimate of how accurately delays could be predicted
\end_layout

\begin_layout Enumerate
analyse how the prediction error changed with the size of the training set
\end_layout

\begin_layout Subsection*
Features affecting delays
\end_layout

\begin_layout Subsection*
Influence of training set size
\end_layout

\begin_layout Standard
In order to study the effect of training set size, we run cross-validated
 linear regression on data sets ranging from 500 to 75,000 samples and measure
 the root mean residual error.
 The data sets are generated by randomly sampling the original data.
 We find that beyond 2000 samples, this error remains practically the same
 for all sample sizes.
 This leads us to conclude that for a well-shuffled data set, the size of
 the training set has little influence beyond a relatively small size of
 2000 points.
\end_layout

\begin_layout Section*
Predicting delay with SVMs
\end_layout

\begin_layout Standard
In order to predict whether a flight will be delayed or not, we model the
 problem as a classification with two classes: 
\emph on
delayed
\emph default
 for flights with delays above 15 minutes, and 
\emph on
non-delayed
\emph default
 otherwise.
 Using the Weka machine learning toolkit, we first applied a naive-bayes
 algorithm with ten-fold cross-validation on the entire training set.
 While extremely fast, the naive-bayes implementation (with Laplace smoothing)
 performs extremely poorly.
 We then use SVMs for classification, since it's known as the best out-of-the-bo
x classification algorithm.
\end_layout

\begin_layout Standard
In order to train SVMs we use a smaller training set of 2000 points.
 There are two reasons for this decision: first, SVMs are much slower to
 train than naive-bayes.
 Second, our preliminary analysis with linear regression shows that a larger
 training set does not add much information to the algorithm.
 Therefore, we use this smaller training set to train the SVM with a gaussian
 kernel.
\end_layout

\begin_layout Standard
Our initial results are quite disappointing.
 While the classifier does a fairly good job at identifying non-delayed
 flights, it performs horribly on predicting delays i.e.
 it has an extremely high false negative rate.
 Our hypothesis is that the skewed class distribution, combined with the
 closeness of points in the two classes is the culprit.
\end_layout

\begin_layout Standard
In order to mitigate the effect of the skewed class distribution, we run
 the SVMs again, but this time setting a 10:1 cost penalty for delays i.e.
 predicting a false negative incurs 10 times the cost of a false positive.
 This step improves our classification result significantly.
\end_layout

\begin_layout Section*
Estimating delay magnitude with non-parametric regression
\end_layout

\begin_layout Standard
Why does linear regression perform so poorly? In order to investigate this
 question, we perform some experiments on a smaller training set (4500 samples)
 and test set (1500) samples.
 We first plot the distributions of the actual and predicted departure delays
 and notice a very large discrepancy.
 While the predicted delays look roughly normally distributed, the actual
 delays are drawn from an extremely skewed distribution.
 
\end_layout

\begin_layout Section*
Exploring Random Forests
\end_layout

\begin_layout Section*
Discussion
\end_layout

\end_body
\end_document
